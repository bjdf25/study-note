### Eureka:

##### 基本架构：

Eureka服务端的服务治理机制提供了完备的RESTful API，所以服务端也支持将非Java语言构建的微服务应用纳入治理框架中，客户端需要其他语言自己实现。RESTful = GET、POST、DELETE、PUT + JSON，JSON这种中立的消息保证了不同语言之间的访问调用。

###### 服务提供者和服务消费者都需要注册到注册中心上，注册中心列表了各个服务的名字以及对应的ip地址，以供消费者咨询。

- 注册中心：eureka的服务端，提供服务注册与服务发现的功能。

  > 注册中心配置中默认设置为自己也是一个服务注册到注册中心，如果是单节点注册中心的话需要将默认注册给关掉；如果是多节点注册中心的话为了实现高可用则会互相将自己注册到其他注册中心节点上。

- 服务提供者:提供服务的应用，可以是spring boot应用，也可以是其他技术平台且遵循eureka通信机制的应用。

  > 服务提供者需要将自身注册到各个注册中心中，在配置文件中填入注册中心地址。（通过@EnableDiscoveryClient注解让该应用注册为Eureka客户端应用，以获得服务发现的能力）服务提供者还要提供自己的名字，这样在注册中心就会有名字和ip地址的对应，其他服务通过名字就能访问到具体地址

- 服务消费者：消费者应用从服务注册中心获取服务列表，从而消费者可以知道去何处调用其所需要的服务，很多时候客户端既是服务提供者也是服务消费者。

  > 主类中@EnableDiscoveryClient注解让该应用注册为Eureka客户端应用，以获得服务发现的能力，同时在该主类中创建RestTemplate的Spring bean实例，并通过LoadBalanced注解开启客户端负载均衡。

    - ribbon客户端负载均衡是通过轮询的机制来实现负载均衡，需要首先发现具体的服务集群然后轮询。
    - 服务消费者请求具体的服务提供者的时候不用写具体的地址，写成该服务的名称就能直接访问。

**很多时候，客户端既是服务提供者也是服务消费者。**

![](images\微服务架构图.png)

**默认服务与注册中心的心跳间隔为30秒，失效间隔为90秒。**

##### 服务调用：

> Eureka中有Region和Zone的概念，一个Region可以包含多个Zone，每个服务客户端需要被注册到一个Zone中，所以每个客户端都对应一个Region和一个Zone。在进行服务调用的时候，优先访问同一个Zone中的服务提供方，若访问不到，就访问其他的Zone。

